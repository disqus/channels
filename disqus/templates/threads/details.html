{% extends "layout.html" %}

{% block subheader %}
  <h2>{{ thread.title }}</h2>
{% endblock %}

{% block head %}
<script type="text/javascript" src="{{ url_for('static', filename='js/jquery.autoresize.js') }}"></script>
<script type="text/javascript">
    var threadId = "{{ thread.id }}";
</script>
{% endblock %}

{% block foot %}
<script type="text/javascript" src="{{ url_for('static', filename='js/thread_details.js') }}"></script>
{% endblock %}

{% block sidebar %}
  <div class="page-header">
    <h4>Sessions</h4>
  </div>
  <ul class="thread-list">
    {% for thread in active_talk_list %}
      {% include "includes/thread.html" %}
    {% endfor %}
  </ul>
  <div class="page-header">
    <h4>Active</h4>
  </div>
  <ul class="thread-list">
    {% for thread in active_thread_list %}
      {% include "includes/thread.html" %}
    {% endfor %}
  </ul>
  <div class="page-header">
    <h4>You</h4>
  </div>
{% endblock %}

{% block content %}
  {% if pycon_session %}
    <div class="row-fluid">
      <div class="span9 topic collapsed">
        <div class="topic-inner">
          <div class="conversation-author">
            <h4><a href="#"><strong>{{ pycon_session.authors }}</strong></a></h4>
            <a class="conversation-link" href="{{ pycon_session.url }}">pycon.org</a>
          </div>
          <div class="conversation-date">
            {{ pycon_session.start|format_datetime(pycon_session.end) }}
            in {{ pycon_session.room }}
          </div>

          <div class="conversation-description">
            <p>{{ pycon_session.description }}</p>
          </div>
        </div>
      </div>
    </div>
  {% endif %}

  <script id="post-template" type="text/template">
    <img src="<%= avatar %>" class="post-avatar">
    <div class="post-meta">
      <span class="post-author">
        <%= name %>
      </span>
      &middot;
      <span class="post-datetime pretty-date" title="<%= createdAtISO %>Z">
        <%= createdAtSince %>
      </span>
    </div>
    <div class="post-message">
      <p><%= message %></p>
    </div>
  </script>

  <div class="conversation{% if pycon_session %} has-topic{% endif %}">
    <ul class="post-list">
    </ul>
  {#    <p>It seems no one is participating in this conversation yet.</p>#}
</div>

<div class="row-fluid">
  <div class="new-reply span9">
    {% if not user %}
      <p>You are not signed in. You can <strong><a href="{{ url_for('oauth_authorize') }}">sign in with Disqus</a></strong>. Need to create an
        account first? <strong><a href="http://disqus.com/profile/signup/">Register a new account</a></strong> on
        disqus.com.</p>
    {% else %}
      <form method="POST" class="form-stack" action="{{ url_for('new_post', thread_id=thread.id) }}">
        {{ form.csrf }}
        <fieldset>
          {{ form.message(rows=2) }} <button type="submit" class="btn btn-large btn-primary">Send Reply</button>
        </fieldset>
      </form>
    {% endif %}
  </div>
</div>
{% endblock %}
